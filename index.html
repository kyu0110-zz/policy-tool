<!DOCTYPE html>
<html>
  <head>
    <title>SMOKE Policy Tool</title>
    <meta charset="utf-8">

    <!-- Support for browsers on mobile phones. -->
    <meta name="viewport"
          content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Google Web Fonts. -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed'
          rel='stylesheet' type='text/css'>

    <!-- Custom CSS styles for our application. -->
    <link rel="stylesheet" href="/static/style.css">

    <!-- The Google JavaScript loader tool (for the Maps, Charts APIs). -->
    <script src="https://www.google.com/jsapi"></script>

    <!-- Our custom JavaScript for Trendy Lights. -->
    <script src="/static/script.js"></script>

  </head>
  <body>

    <!-- The DOM of our application. -->
    <div class="trendy">

      <!-- A container which the Maps API will populate with a map. -->
      <div class="map"></div>

      <!-- Tab that says expand for the details panel -->
      <div class="detailstab">Click for details</div>
          
      <!-- Chart showing the contribution from each province -->
      <div class='panel'>
        <div class="title"></div>
        <div class="close">hide</div>
        <br>
        <div class="subtitle"></div>
        <div class="details">
          <div class="receptorTimeSeries"></div>
          <div class='sourcePie'></div>
        </div>
      </div>

      <div class="abouttab">
          <div class="aboutclose" align="left">[close]</div>
          <h1>Overview. </h1>
      This tool enables users to calculate the effects of smoke emissions in Equatorial Asia on haze
      Singapore. It was developed at Harvard University, using the GEOS-Chem chemical transport
      model, following Kim et al. (2015) and Koplitz et al. (2016). The tool shows where burning took
      place since 1997, and predicts where burning will occur under a Business-as- Usual (BAU)
      scenario in the future. The tool further reveals the impact that this burning has on fine particulate
      matter (PM) in Singapore. PM is a major component of haze.
      <h1>Details. </h1> 
      Users can select a particular year in the past or future and apply one of five patterns of transport
      that carry the smoke from the fire sources to the receptor Singapore. The patterns come from
      2005-2009 meteorology. For the historical time period, two fire emission inventories can be
      applied: the Global Fire Emissions Database version 4 with small fires (GFED4, 1997-2016) and
      the Global Fire Assimilation System (GFAS, 2003-2016). For the future time period, the BAU
      scenario serves as default, with less extreme scenarios also possible. For example, users can
      choose a scenario from which emissions from peatlands are excluded.
      Given specific years for emissions and transport, the tool presents the timeseries of monthly
      mean haze PM in Singapore in the panel at left. The panel also shows a pie chart that quantifies
      the contribution of each Indonesian province to that year’s haze in Singapore. With the GEOS-
      Chem switch, users can create maps showing the sensitivity of Singapore PM to fire emissions in
      gridcells across the region, as well as maps of the PM contributions from each gridcell to the
      Singapore total PM. The landcover switch displays land types for that year, and the emissions
      switch shows which areas burned.
      <div class="citation">
      Kim, P. S., Jacob, D. J., Mickley, L. J., Koplitz, S. N., Marlier, M. E., DeFries, R. S., et al.
      (2015). Sensitivity of population smoke exposure to fire locations in Equatorial Asia.
      <i>Atmospheric Environment</i>, 102(C), 11–17. <br>
      Koplitz, S. N., Mickley, L. J., Marlier, M. E., Buonocore, J. J., Kim, P. S., Liu, T., et al. (2016).
      Public health impacts of the severe haze in Equatorial Asia in September–October 2015:
      demonstration of a new framework for informing fire management strategies to reduce
      downwind smoke exposure. <i>Environmental Research Letters</i>, 11(9), 094023–11.</div>
      </div>

      <!-- Tab that allows for designing scenarios -->
      <div class="scenariotab">Design scenario</div>

      <!-- Scenario design panel -->
      <div class="scenarioUI">
        <div class="close">Hide</div>
        <!-- The title of the application. -->
        <h2>Design scenario</h2>
        <table>
            <tr>
                <td>
                    Emission Inventory <br>
                    <form>
                        <select id="scenario" name="scenario">
                            <option value="GFED4">GFED4.1 with small fires</option>
                            <option value="Miriam">Downscaled GFED</option>
                            <option value="GFAS">GFAS</option> 
                        </select>
                    </form>
                </td>
                <td>
                Meteorological year
                <br>
                <form>
                <select id="metYear" name="metYear">
                    <option value=2005>2005</option>
                    <option value=2006 selected="selected">2006</option>
                    <option value=2007>2007</option>
                    <option value=2008>2008</option>
                    <option value=2009>2009</option>
                </select>
                </form>
                </td>
            </tr>
            <tr>
                <td>
              Emissions year
              <br>
              <form oninput="emissYearOutput.value = parseInt(emissYear.value);" onsubmit="return false;">
              <input id="emissYear" name="emissYear" type="range" min="1997" max="2029" value="2006">
              <output for="emissYear" name="emissYearOutput">2006</output>
              </form>
                </td>
                <td>
                    <div id="emiss_description" style="font-size: 10pt">
                        <div style="font-weight: bold">Valid years:</div> 
                        1997-2016 for GFED4 <br>
                        2005-2029 for Downscaled GFED <br>
                        2003-2016 for GFAS
                    </div>
                </td> 
            </tr>
            <tr>
                <td colspan=2>
                    Remove emissions from: <br>
                    Concessions:
                    <input type="checkbox" id="logging">Logging 
                    <input type="checkbox" id="oilpalm">Oil Palm 
                    <input type="checkbox" id="timber">Timber <br>
                    Other regions: 
                    <input type="checkbox" id="peatlands">Peatlands 
                    <input type="checkbox" id="conservation">Conservation areas
                    <br>
                    <button id="get">Submit scenario</button>
                </td>
            </tr>
        </table>
      </div>

      <!-- UI -->
      <div class='layerUI'>
        <table>
          <tr>
            <td rowspan="2">
            <!-- The title of the application. -->
            <h1>PM exposure in Singapore</h1>
            <div style="font-size: 13pt; padding-left: 20px; position: absolute; bottom: 10px">With support from <img src="static/Swiss_Re.png" width="100"><div class="aboutshow">[about]</div></div>
            </td>
            <td colspan="4">
                <b>Map Layers:</b>
            </td>
          </tr>
          <tr valign="top">
              <td>
                  <label class="switch">
                      <input type="checkbox" id="landcover">
                      <div class="slider"></div>
                  </label>
                  Landcover<br>
                  <div class="landcover" style="font-size: 10pt">
                  <input type="radio" name="landYear" id="BAU2005" value="BAU2005"><label for="BAU2005">2005</label>
                  <input type="radio" name="landYear" id="BAU2010" value="BAU2010" checked="true"><label for="BAU2010">2010</label><br>
                  <input type="radio" name="landYear" id="BAU2015" value="BAU2015"><label for="BAU2015">2015</label>
                  <input type="radio" name="landYear" id="BAU2020" value="BAU2020"><label for="BAU2020">2020</label><br>
                  <input type="radio" name="landYear" id="BAU2025" value="BAU2025"><label for="BAU2025">2025</label>
                  <input type="radio" name="landYear" id="BAU2030" value="BAU2030"><label for="BAU2030">2030</label>
                  </div>
                  </td>
                   <td align="right" width="15" style="padding-right:0">
                      <svg width="15" height="80">
                            <rect width="12" height="12" y="0" style="fill:#9d9d9d" />
                            <rect width="12" height="12" y="16.5" style="fill:#000000" />
                            <rect width="12" height="12" y="33" style="fill:#fdb751" />
                            <rect width="12" height="12" y="49.5" style="fill:#ff0000" />
                      </svg>
                  </td> 
                  <td align="left" style="padding-left:0">
                      <div style="font-size:10.5pt">
                      Degraded <br>
                      Intact <br>
                      Non-Forest <br>
                      Plantations</div>
                  </td> 
            <td>
                <label class="switch">
                      <input type="checkbox" id="emissions">
                      <div class="slider"></div>
                  </label>
            Emissions
            </td>
            <td align="right" width="15" style="padding-right:0">
                <svg width="15" height="65">
                            <rect width="11" height="11" y="1" style="fill:#FFFFFF"/>
                            <rect width="11" height="11" y="12" style="fill:#FFFF00"/>
                            <rect width="11" height="11" y="22" style="fill:#FFC100"/>
                            <rect width="11" height="11" y="33" style="fill:#FF7700"/>
                            <rect width="11" height="11" y="44" style="fill:#DE2700"/>
                            <rect width="11" height="11" y="55" style="fill:#761200"/>
                </svg>
            </td>
            <td align="left" style="padding-left:0">
                <div style="font-size:10.5pt">
                0 
                <br>
                <br>
                <br>
                10 ug/s/m^2
                </div>
            </td>
            <td>
                <label class="switch">
                    <input type="checkbox" id="geoschem" checked="true">
                    <div class="slider"></div>
                </label>
                GEOS-Chem<br>
                <input type="radio" name="gclayer" id="sensitivity" value="sensitivity"><label for="sensitivity">Sensitivity</label><br>
                    <input type="radio" name="gclayer" id="PM" value="PM" checked="true"><label for="PM">PM contribution</label>
            </td>
            <td align="right" width="15" style="padding-right:0">
                <svg width="15" height="65">
                            <rect width="11" height="11" y="1" style="fill:#FFFFFF"/>
                            <rect width="11" height="11" y="12" style="fill:#fF9Cff"/>
                            <rect width="11" height="11" y="22" style="fill:#FF00b4"/>
                            <rect width="11" height="11" y="33" style="fill:#CC00ff"/>
                            <rect width="11" height="11" y="44" style="fill:#5F00e5"/>
                            <rect width="11" height="11" y="55" style="fill:#0003ae"/>
                </svg>
            </td>
            <td align="left" style="padding-left:0">
                <div style="font-size:10.5pt">
                0
                <br>
                <br>
                <br>
                <div class="GClegend">
                0.05 ug/m^3 
                </div>
                </div>
            </td>
            </tr>
        </table>
      </div>
    </div>
    <script>
      smoke.boot(
          '{{ eeMapId | safe }}',
          '{{ eeToken | safe }}',
          '{{ boundaries | safe}}',
          '{{ totalPM | safe}}',
          '{{ provincial | safe}}',
          '{{ timeseries | safe}}',
          '{{ scenario | safe}}');
    </script>

  </body>
</html>
